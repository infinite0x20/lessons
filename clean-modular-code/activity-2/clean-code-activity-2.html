
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Activity 2 - DRY Code & Functions" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://www.pyopensci.org/lessons/clean-modular-code/activity-2/clean-code-activity-2.html" />
<meta property="og:site_name" content="pyOpenSci Python Package Guide" />
<meta property="og:description" content="In activity 1, you took some code and made it cleaner and easier to understand by: using expressive variable names,, following PEP8 code style guidelines, and, creating pseudocode as a way to creat..." />
<meta property="og:image:width" content="1146" />
<meta property="og:image:height" content="600" />
<meta property="og:image" content="https://www.pyopensci.org/lessons/_images/social_previews/summary_clean-modular-code_activity-2_clean-code-activity-2_4fc2c0ab.png" />
<meta property="og:image:alt" content="In activity 1, you took some code and made it cleaner and easier to understand by: using expressive variable names,, following PEP8 code style guidelines, an..." />
<meta name="description" content="In activity 1, you took some code and made it cleaner and easier to understand by: using expressive variable names,, following PEP8 code style guidelines, and, creating pseudocode as a way to creat..." />
<meta name="twitter:card" content="summary_large_image" />
    <link href="https://www.pyopensci.org/images/favicon.ico" rel="icon" type="image/x-icon">
    <title>Activity 2 - DRY Code &amp; Functions &#8212; pyOpenSci Lessons</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/pyos-sphinx-theme.css?v=fb569b27" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Itim&family=Poppins:wght@400;700&family=Work+Sans:wght@400;700" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../_static/documentation_options.js?v=2709fde1"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'clean-modular-code/activity-2/clean-code-activity-2';</script>
    <script src="../../_static/matomo.js?v=918da087"></script>
    <link rel="canonical" href="https://www.pyopensci.org/lessons/clean-modular-code/activity-2/clean-code-activity-2.html" />
    <link rel="icon" href="https://www.pyopensci.org/images/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Activity 3: Tests &amp; Checks for your code" href="../activity-3/clean-code-activity-3.html" />
    <link rel="prev" title="Clean, Modular Code: Activity 1" href="../activity-1/clean-code-activity-1.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>


  <div class="bd-header-announcement container-fluid bd-header-announcement">
    <div class="bd-header-announcement__content"><p><a href='https://www.pyopensci.org/about-peer-review/index.html'>We run peer review of scientific Python software. Learn more.</a></p></div>
  </div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo-light-mode.png" class="logo__image only-light" alt="pyOpenSci Python Package Guide. The pyOpenSci logo is a purple flower with pyOpenSci under it. The o in open sci is the center of the flower"/>
    <script>document.write(`<img src="../../_static/logo-dark-mode.png" class="logo__image only-dark" alt="pyOpenSci Python Package Guide. The pyOpenSci logo is a purple flower with pyOpenSci under it. The o in open sci is the center of the flower"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../intro-clean-code.html">
                        Lessons
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://www.pyopensci.org">
                    pyOpenSci Website
                  </a>
                </li>
                

                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://www.pyopensci.org/software-peer-review">
                    Peer Review Guide
                  </a>
                </li>
                

                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://pyopensci.org/handbook">
                    Handbook
                  </a>
                </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pyopensci/lessons" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://fosstodon.org/@pyOpenSci" title="Mastodon" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-mastodon fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Mastodon</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../intro-clean-code.html">
                        Lessons
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://www.pyopensci.org">
                    pyOpenSci Website
                  </a>
                </li>
                

                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://www.pyopensci.org/software-peer-review">
                    Peer Review Guide
                  </a>
                </li>
                

                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://pyopensci.org/handbook">
                    Handbook
                  </a>
                </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pyopensci/lessons" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://fosstodon.org/@pyOpenSci" title="Mastodon" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-mastodon fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Mastodon</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Clean, Expressive Code</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../intro-clean-code.html">Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pep-8.html">Python Code Style</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-dry-modular-code.html">Don't Repeat Yourself</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-expressive-code.html">Expressive Code</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Functions, Conditionals &amp; Checks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../checks-conditionals/python-conditionals.html">Conditional statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../checks-conditionals/about-python-functions.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../checks-conditionals/write-python-functions.html">How to write a Python function</a></li>



<li class="toctree-l1"><a class="reference internal" href="../checks-conditionals/python-function-checks.html">Function checks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../checks-conditionals/python-common-exceptions.html">Common Python exceptions</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Activities</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../activity-1/clean-code-activity-1.html">Clean Code: Activity 1</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Clean Code: Activity 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../activity-3/clean-code-activity-3.html">Clean Code: Activity 3</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../intro-clean-code.html" class="nav-link">Write Clean, Modular, DRY Code</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Activity 2...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="activity-2-dry-code-functions">
<h1>Activity 2 - DRY Code &amp; Functions<a class="headerlink" href="#activity-2-dry-code-functions" title="Link to this heading">#</a></h1>
<p>In <a class="reference internal" href="../activity-1/clean-code-activity-1.html"><span class="doc std std-doc">activity 1</span></a>, you took some code and made  it cleaner and easier to understand by:</p>
<ul class="simple">
<li><p>using expressive variable names,</p></li>
<li><p>following PEP8 code style guidelines, and</p></li>
<li><p>creating pseudocode as a way to create a plan to clean up the code and make it easier to maintain.</p></li>
</ul>
<p>In this activity, you will make the code <a class="reference internal" href="../python-dry-modular-code.html"><span class="doc std std-doc">DRY which stands for Don’t Repeat Yourself</span></a>.</p>
<p>You can use the script you worked on in Activity 1 here or the cleaned-up script provided below.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In <a class="reference internal" href="../activity-3/clean-code-activity-3.html"><span class="doc std std-doc">activity 3</span></a>, you will</p>
<ul class="simple">
<li><p>Use conditional statements to control if and when code is executed.</p></li>
<li><p>Add checks to your code</p></li>
</ul>
</div>
<section id="the-clean-code-strategies">
<h2>The clean code strategies<a class="headerlink" href="#the-clean-code-strategies" title="Link to this heading">#</a></h2>
<p>In this activity, you will focus on the following clean code strategies:</p>
<ul class="simple">
<li><p><strong>Document:</strong> Document what the code does by adding a docstring at the top of the script to help your future self, a future lab member, or another user understand your code’s tasks. Use Numpy-style docstrings when possible.</p></li>
<li><p><strong>Modularize</strong> Make your code more modular by adding functions that perform small, repeated tasks. Functions should also have docstrings and expressive names for added readability and usability.</p></li>
<li><p><strong>Use Loops</strong> Eliminate repetition by using loops that will iterate over specific tasks. In this case, you will iterate over processing several files.</p></li>
<li><p><strong>Create dynamic paths:</strong> Dynamic paths ensure that your code will run on other machines regardless of operating system. To achieve this in Python, you can use <code class="docutils literal notranslate"><span class="pre">os</span></code> or <code class="docutils literal notranslate"><span class="pre">pathlib</span></code> to create paths</p></li>
</ul>
</section>
<section id="to-begin-identify-redundant-parts-of-this-code">
<h2>To begin - identify redundant parts of this code<a class="headerlink" href="#to-begin-identify-redundant-parts-of-this-code" title="Link to this heading">#</a></h2>
<p>Create pseudocode (or text) describing the process steps represented in the code below. How could the code be organized differently and more efficiently?</p>
<p>What tools could make the code more DRY?</p>
</section>
<section id="reproducibility-will-your-code-run-on-other-machines">
<h2>Reproducibility: will your code run on other machines?<a class="headerlink" href="#reproducibility-will-your-code-run-on-other-machines" title="Link to this heading">#</a></h2>
<p>When considering workflow reproducibility, ensuring that your code runs seamlessly across different machines is important. Hard-coded paths (e.g., <code class="docutils literal notranslate"><span class="pre">data\part-1-data.json</span></code>) can cause errors. For example:</p>
<ul class="simple">
<li><p>The path <code class="docutils literal notranslate"><span class="pre">data/part-1-data.json</span></code> is a POSIX path, which works on Mac and Linux machines but will fail on Windows because Windows uses backslashes (<code class="docutils literal notranslate"><span class="pre">\</span></code>) for paths.</p></li>
<li><p>Similarly, a path like <code class="docutils literal notranslate"><span class="pre">data\part-1-data.json</span></code>, written for Windows, will fail on Mac and Linux systems, which expect forward slashes (<code class="docutils literal notranslate"><span class="pre">/</span></code>) in their paths.</p></li>
</ul>
<p>To avoid these issues, file paths should be constructed dynamically using tools like Python’s <code class="docutils literal notranslate"><span class="pre">pathlib</span></code>. Using <code class="docutils literal notranslate"><span class="pre">pathlib</span></code> will ensure path compatibility across different operating systems by automatically using the correct path format for the system on which your code is running.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<ul class="simple">
<li><p>“POSIX” refers to a set of standards for maintaining compatibility between operating systems, and Mac systems are POSIX-compliant.</p></li>
<li><p>You can also use <code class="docutils literal notranslate"><span class="pre">os.path.join</span></code> to create paths; however, using <code class="docutils literal notranslate"><span class="pre">pathlib</span></code> is a more modern and flexible approach.</p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pathlib</span>

<span class="c1"># Dynamically generate a path so it will be correct on a Windows vs MAC vs Linux machine</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;data&quot;</span> <span class="o">/</span> <span class="s2">&quot;data.json&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data/data.json
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;data&quot;</span>

<span class="c1"># Use pathlib.path.glob to find all .json files in the &#39;data&#39; directory</span>
<span class="n">json_files</span> <span class="o">=</span> <span class="n">data_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.json&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">json_file</span> <span class="ow">in</span> <span class="n">json_files</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data/part-1-data.json
data/part-1-datab.json
</pre></div>
</div>
</div>
</div>
<section id="applying-functions-to-pandas-dataframe-values-apply">
<h3>Applying functions to <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> values - <code class="docutils literal notranslate"><span class="pre">.apply</span></code><a class="headerlink" href="#applying-functions-to-pandas-dataframe-values-apply" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.apply()</span></code> function allows you to apply any function to the rows or columns of a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>. You can use it to perform operations on specific column or row values. When using <code class="docutils literal notranslate"><span class="pre">.apply()</span></code>, you can specify whether the function should be applied across columns (<code class="docutils literal notranslate"><span class="pre">axis=0</span></code>, the default) or across rows (<code class="docutils literal notranslate"><span class="pre">axis=1</span></code>).</p>
<ul class="simple">
<li><p>To apply a function to each row of a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>, use <code class="docutils literal notranslate"><span class="pre">df.apply(your_function,</span> <span class="pre">axis=1)</span></code>.</p></li>
<li><p>To apply a function to a specific column across all rows, use <code class="docutils literal notranslate"><span class="pre">df[&quot;column-name&quot;].apply(your_function)</span></code>.</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">.apply()</span></code> method in pandas is an efficient way to replace <code class="docutils literal notranslate"><span class="pre">for</span></code> loops for processing row and column values in a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<p>In this activity, we encourage you to test out using apply as an efficient way to process data in each cell of a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>. An example of using <code class="docutils literal notranslate"><span class="pre">.apply</span></code> is below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Example DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">]})</span>

<span class="c1"># Function to categorize the sum of columns &quot;A&quot; and &quot;B&quot;</span>
<span class="k">def</span> <span class="nf">categorize_sum</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="n">total</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">total</span> <span class="o">&gt;</span> <span class="mi">15</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;high&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;low&quot;</span>

<span class="c1"># Apply the function to each row</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">categorize_sum</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>4</td>
      <td>low</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10</td>
      <td>5</td>
      <td>low</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>15</td>
      <td>high</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="attention admonition">
<p class="admonition-title">Activity 2: Part 1</p>
<p>Examine the code in the cell below and do the following:</p>
<ol class="arabic simple">
<li><p>Identify what areas of the code are redundant.</p></li>
<li><p>Create pseudocode for the repeated steps; use that pseudocode to clean up the code. Important: Don’t skip ahead and write any code yet.</p></li>
</ol>
</div>
<div class="attention admonition">
<p class="admonition-title">Activity 2: Part 2</p>
<p>When you are happy with your pseudocode, refactor the code. Refactoring means improving your code’s structure and readability without changing its behavior. It makes the code cleaner, more efficient, and easier to maintain.</p>
<ol class="arabic simple">
<li><p>Identify sections of the code that could be combined into functions</p></li>
<li><p>When you finish the above, refactor the code so it is cleaner and more modular.</p></li>
</ol>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is what the code could look like after part 1. In part 2, </span>
<span class="c1"># you will take this code and make it more DRY.</span>

<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Use pathlib to ensure your code runs on other machines (assuming relative paths)</span>
<span class="c1"># Should we do this in part 2 or part 1??</span>
<span class="n">file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;part-1-data.json&quot;</span>

<span class="c1"># Load JSON data</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
    <span class="n">json_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span>

<span class="c1"># Normalize JSON data into a flat table</span>
<span class="n">normalized_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">json_data</span><span class="p">)</span>

<span class="c1"># Define columns to keep</span>
<span class="n">columns_to_keep</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;publisher&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DOI&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">,</span>
    <span class="s2">&quot;author&quot;</span><span class="p">,</span>
    <span class="s2">&quot;is-referenced-by-count&quot;</span><span class="p">,</span>
    <span class="s2">&quot;title&quot;</span><span class="p">,</span>
    <span class="s2">&quot;published.date-parts&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="c1"># Filter the DataFrame by the desired columns</span>
<span class="n">papers_df_1</span> <span class="o">=</span> <span class="n">normalized_data</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">items</span><span class="o">=</span><span class="n">columns_to_keep</span><span class="p">)</span>

<span class="c1"># Iterate through each row and extract date and title</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">papers_df_1</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">date_parts</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;published.date-parts&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">papers_df_1</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">papers_df_1</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">formatted_date</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">date_parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">date_parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">date_parts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">published_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">formatted_date</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">papers_df_1</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s2">&quot;published_date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">published_date</span>

<span class="c1"># Drop the original &quot;published.date-parts&quot; column</span>
<span class="n">papers_df_1</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;published.date-parts&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Print the shape of the first DataFrame</span>
<span class="nb">print</span><span class="p">(</span><span class="n">papers_df_1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># Load and process the second JSON data</span>
<span class="n">file_path_b</span> <span class="o">=</span> <span class="s2">&quot;data/part-1-datab.json&quot;</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path_b</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file_b</span><span class="p">:</span>
    <span class="n">json_data_b</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file_b</span><span class="p">)</span>

<span class="n">normalized_data_b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">json_data_b</span><span class="p">)</span>

<span class="c1"># Filter the second DataFrame by the same columns</span>
<span class="n">papers_df_2</span> <span class="o">=</span> <span class="n">normalized_data_b</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">items</span><span class="o">=</span><span class="n">columns_to_keep</span><span class="p">)</span>

<span class="c1"># Iterate through each row and extract date and title for the second DataFrame</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">papers_df_2</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">date_parts_b</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;published.date-parts&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">papers_df_2</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">papers_df_1</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">formatted_date_b</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">date_parts_b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">date_parts_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">date_parts_b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="n">published_date_b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">formatted_date_b</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">papers_df_2</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s2">&quot;published_date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">published_date_b</span>

<span class="c1"># Drop the original &quot;published.date-parts&quot; column from the second DataFrame</span>
<span class="n">papers_df_2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;published.date-parts&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Concatenate the two DataFrames</span>
<span class="n">combined_papers_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">papers_df_1</span><span class="p">,</span> <span class="n">papers_df_2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Print the shape of the combined DataFrame</span>
<span class="n">combined_papers_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(17, 7)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(27, 7)
</pre></div>
</div>
</div>
</div>
<div class="attention admonition">
<p class="admonition-title">On Your Own 1</p>
<p>If you complete the above activity with time to spare, here are a few additional tasks you can work on.</p>
<p>In the JSON data that you have been processing, the package titles can be found in the title column as follows: <code class="docutils literal notranslate"><span class="pre">&quot;package-name:</span> <span class="pre">title</span> <span class="pre">here.&quot;</span></code></p>
<ol class="arabic simple">
<li><p>Add a processing step to the code that pulls the package name out from the title column and creates a new column called <code class="docutils literal notranslate"><span class="pre">package-name</span></code>.</p></li>
<li><p>Create a workflow that calculates how many packages in that list are pyOpenSci packages. To calculate how many are pyOpenSci packages,   you will need the <code class="docutils literal notranslate"><span class="pre">pyos-joss-accepted-packages.csv</span></code> file in the <code class="docutils literal notranslate"><span class="pre">data/</span></code> directory with the activity 2 JSON data. This .csv file lists all pyOpenSci packages that have also gone through JOSS review.</p></li>
</ol>
</div>
<p>If you still have time, below is another challenge for you to try!</p>
<div class="attention admonition">
<p class="admonition-title">On Your Own 2</p>
<p>Create a new workflow that calculates how many packages were submitted to JOSS each month. Add documented functions that process the data.</p>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><i class="fa-solid fa-eye"></i> TODOs– Click to expand dropdown</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Hidden content</p>
<ul class="simple">
<li><p class="sd-card-text">TODO: add drop-downs with answers to each of the OYOs.</p></li>
</ul>
</div>
</details></section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../activity-1/clean-code-activity-1.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Clean, Modular Code: Activity 1</p>
      </div>
    </a>
    <a class="right-next"
       href="../activity-3/clean-code-activity-3.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Activity 3: Tests &amp; Checks for your code</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-clean-code-strategies">The clean code strategies</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#to-begin-identify-redundant-parts-of-this-code">To begin - identify redundant parts of this code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reproducibility-will-your-code-run-on-other-machines">Reproducibility: will your code run on other machines?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#applying-functions-to-pandas-dataframe-values-apply">Applying functions to <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> values - <code class="docutils literal notranslate"><span class="pre">.apply</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/pyopensci/lessons/edit/main/clean-modular-code/activity-2/clean-code-activity-2.md">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../_sources/clean-modular-code/activity-2/clean-code-activity-2.md.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item"><p>
    pyOpensci is dedicated to creating a welcoming, supportive and diverse
    community around the open source Python tools that drive open science. Our
    <a
      href="https://www.pyopensci.org/handbook/CODE_OF_CONDUCT.html"
      target="_blank"
      >Code of Conduct</a
    >
    defines expected behavior and guidelines that help create such a community.
  </p></div>
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, pyOpenSci.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
</div>

  </footer>
  </body>
</html>